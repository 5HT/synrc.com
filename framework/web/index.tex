\documentclass[11pt]{article}
\usepackage{ifthen}
\usepackage{graphicx}
\usepackage{cite}
\usepackage{hevea}
\input{../../synrc.hva}
%HEVEA \loadcssfile{../../synrc.css}
\begin{document}

\title{N2O: Overview}
\author{Maxim Sokhatsky}

%HEVEA \begin{divstyle}{nonselectedwrapper}
%HEVEA \begin{divstyle}{article}
%HEVEA \begin{divstyle}{smallcol}
\paragraph{}
\includeimage{images/n2o.png}
%HEVEA \end{divstyle}
%HEVEA \begin{divstyle}{articlecol}
\section*{N2O: Erlang Web Framework on WebSockets}

\subsection*{WebSockets transport}
Nitrogen 2 Optimized, N2O was started as the first Erlang Web Framework
that fully relies on WebSocket transport. Great compatibility with Nitrogen
was retained and many improvements were made, such as binary page construction,
binary data transfer, all events wired over WebSocket channel, minumum process spawns,
work within Cowboy processes. Page renderer in N2O is several times faster
than in original Nitrogen.

\subsection*{Binary events over WebSockets}
N2O doesn't use JSON, all message data passed over websockets are encoded with
native Erlang External Term Format which is easily parsed in JavaScript
with {\bf Bert.decode(msg)} and helps to avoid complexity on server-side.
Please refer to \footahref{http://bert-rpc.org}{http://bert-rpc.org} for more information.

\subsection*{Optimized for speed}
Original Nitrogen was tested in production under high-load and we decided to drop out
{\bf nprocreg} process registry along with {\bf{action\_comet}} heavy process creation. N2O now creates
only one process for async websocket handler, all async operations are handled withing
Cowboy processes.

\subsection*{Why Erlang in Web ?}
We've measured all existing modern web frameworks built with functional languages and Cowboy still the king.
On the chart you can see raw HTTP performance of functional and C-like languages with concurrent primitives (Go, D and Rust)
on VAIO Z notebook with i7640M processor:

%HEVEA \rawhtmlinput{templates/webservers.htx}

N2O outperforms full Nitrogen stack with only 2X downgrade of raw HTTP Cowboy
performance thus rising rendering performance several times in comparison to
any other functional web framework and for sure it is faster than raw HTTP node.js performance.

\subsection*{Desktop and Mobile Applications}
There are two approaches to design communications between client/server.
The first one is called 'data-on-wire', where only JSON, XML or Binary
data are transfered on the channel through RPC, REST. All HTML rendering
is done on the client side. This is mostly suitable for desktops
applications. The examples are Chaplin/CoffeScript and Meteor/JavaScript.
\paragraph{}
The other approach is to send pre-rendered parts of pages and javascript,
and only replace HTML parts and execute JavaScript on the client side. This approach
is better suited for mobile applications, where client doesn't have much resources.
\paragraph{}
With N2O you can create both types of applications: using N2O REST framework
for first type of application based on Cowboy REST API along with DTL
templates for initial HTML renderings. And also Nitrogen DSL-based approach
to model parts of the pages as widgets and control elements thanks to rich
Nitrogen elements collections provided by Nitrogen community.
\paragraph{}
In the cases where your system is built around Erlang infrastructure, N2O
is the best choice that you can make for fast web prototyping, simpicity
of use and codebase clearity. Despite HTML tranfer over the wire,
you will still have access to all your erlang services directly.

\subsection*{Templates vs DSL}
We liked Nitrogen for simple and elegant way of typed HTML page
construction with DSL, based on the host language as it is done in Scala Lift,
OCaml Ocsigen and Haskell Blaze. It helps to develop re-usable control
elements and components using the host language.
\paragraph{}
Template-based approach pushes programmers to deal with raw HTML,
like Yesod, ASP, PHP, JSP, Rails, Yaws, ChicagoBoss. It helps to
define the page in terms of top-level controls, playholders
and panels. So N2O combines both approaches.
\paragraph{}
Main N2O attraction is the fast prototyping. We also use it in large
scale projects. Here is the complete Web Chat example working with
WebSockets that demonstrates the use of Templates, DSL and async
interprocesses communications:

%HEVEA \rawhtmlinput{templates/chat.htx}

And try to build the similar functionality with your favourite language/framework.

\subsection*{Clean codebase and pure render}
We feel free to brake some of the compatability with the original
Nitrogen framework, mostly because we want to have a clean codebase
and fastest speed. However, it is still possible to easily port
Nitrogen web sites to N2O. E.g. N2O returns id and class semantics
of HTML and not html_id. We simplified HTML rendering by not using
html_encode which should be handled by the application layer.
Nitrogen.js that was originally created by Rusty Klophaus,
was removed because of pure WebSocket nature of N2O which does not
require XHR helper methods on the client. We added XHR fallback
handling by using 'Bullet' library written by Loc Hoguin.
We also dropped simple_bridge and optimized N2O at every level to
archive the maximum performance and simplicity. We hope you will enjoy
using N2O and we are confident that it is the most productive way to
build Web applications with Erlang.

%HEVEA \rawhtmlinput{templates/n2o_render_sample.htx}

%HEVEA \rawhtmlinput{templates/disqus.htx}

%HEVEA \end{divstyle}

%HEVEA \begin{divstyle}{toc last}

\input{toc}

%HEVEA \end{divstyle}

%HEVEA \end{divstyle}
%HEVEA \end{divstyle}
%HEVEA \begin{divstyle}{clear}{~}\end{divstyle}

\end{document}
